import zipfile
from threading import Thread

def extractFile(zFile, chunk):

    for i in chunk:
        try:
            zFile.extractall(pwd=i)
            print("[+] Password Found: " + i.decode())
            
        except:
            continue
    print("done")


    

def main():
    zFile = zipfile.ZipFile('crackme.zip')
    passFile = open("../rockyou.txt", "rb")

    print("[*] Generating Rainbow Chunks")
    all_lines = passFile.readlines()
    
    
    chunks_num = int(len(all_lines)/1000) + 1

    chunk = []
    for i in all_lines:
        if len(chunk) == 100:
            # Generate new thread
            print("Generating Thread for Chunk: " + str(chunks_num))
            t = Thread(target=extractFile, args=[zFile, chunk])
            t.start()
            # Reset chunk
            chunk = []
        else: 
            if chr(i[-1]) == '\n':
                chunk.append(i[0:-1])
            else:
                chunk.append(i)



if __name__ == '__main__':
    main()